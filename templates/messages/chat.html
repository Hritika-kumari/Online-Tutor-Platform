{% extends 'base.html' %}

{% block title %}Chat with {{ other_user.username }}{% endblock %}

{% block content %}
<div class="max-w-4xl mx-auto bg-white rounded-lg shadow-md">
  <div class="p-6 border-b">
    <h2 class="text-2xl font-bold text-gray-800">
      Chat with {{ other_user.username }}
    </h2>
  </div>

  <div class="p-6 h-96 overflow-y-auto bg-gray-50">
    {% for message in messages %}
    <div class="mb-4 {% if message.sender == user %}text-right{% endif %}">
      <div
        class="inline-block max-w-md p-4 rounded-lg {% if message.sender == user %}bg-blue-600 text-white{% else %}bg-white border border-gray-200{% endif %}"
      >
        <p class="font-semibold mb-1">{{ message.sender.username }}</p>
        <p>{{ message.content }}</p>
        <p
          class="text-xs mt-2 {% if message.sender == user %}text-blue-100{% else %}text-gray-400{% endif %}"
        >
          {{ message.created_at|date:"M d, Y H:i" }}
        </p>
      </div>
    </div>
    {% empty %}
    <p class="text-gray-600 text-center">
      No messages yet. Start the conversation!
    </p>
    {% endfor %}
  </div>

  <form method="post" class="p-6 border-t">
    {% csrf_token %}
    <div class="flex gap-4">
      <input
        type="text"
        name="content"
        required
        placeholder="Type your message..."
        class="flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
      />
      <button
        type="submit"
        class="px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700"
      >
        Send
      </button>
    </div>
  </form>
</div>

<a
  href="{% url 'message_list' %}"
  class="block mt-4 text-center text-blue-600 hover:underline"
  >Back to Messages</a
>
{% endblock %}
